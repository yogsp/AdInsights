} />
                        <FeedbackCard title="Areas for Improvement" items={analysisResult.improvements} icon={<XCircle className="text-red-500"/>} />
                      </div>
                      <DetailedAnalysis data={analysisResult.analysis} />
                    </div>
                )}
            </div>
        </div>
    );
};

// --- Analysis Result Components ---
const scoreColor = (score) => {
    if (score >= 85) return 'text-green-500 bg-green-50';
    if (score >= 60) return 'text-yellow-500 bg-yellow-50';
    return 'text-red-500 bg-red-50';
}

const OverallScore = ({ score, oneLiner }) => (
    <div className="text-center p-6 bg-slate-50 rounded-xl">
        <p className="font-semibold text-slate-600 mb-2">Predicted Performance Score</p>
        <div className={`mx-auto w-28 h-28 rounded-full flex items-center justify-center ${scoreColor(score)}`}>
            <span className="text-5xl font-bold">{score || 0}</span>
            <span className="text-2xl font-semibold mt-2">/100</span>
        </div>
        <p className="text-slate-700 font-semibold mt-4 text-lg italic">"{oneLiner || 'Analysis summary unavailable.'}"</p>
    </div>
);

const FeedbackCard = ({ title, items, icon }) => (
    <div className="bg-slate-50/70 p-4 rounded-lg">
        <h3 className="font-bold text-lg text-slate-800 mb-3 flex items-center">
            <span className="mr-2">{icon}</span>
            {title}
        </h3>
        <ul className="space-y-2">
            {(items && items.length > 0) ? items.map((item, index) => (
                <li key={index} className="flex items-start">
                    <Star className="w-4 h-4 text-indigo-400 mr-2 mt-1 flex-shrink-0" />
                    <span className="text-slate-600 text-sm">{item}</span>
                </li>
            )) : <li className="text-slate-500 text-sm">No items to display.</li>}
        </ul>
    </div>
);

const DetailedAnalysis = ({ data }) => {
  const analysisItems = useMemo(() => {
      if (!data) return [];
      return [
        {
            icon: <Palette className="w-6 h-6 text-indigo-500" />,
            title: "Color Palette",
            vibe: data.colorPalette?.vibe,
            recommendation: data.colorPalette?.recommendation,
        },
        {
            icon: <Users className="w-6 h-6 text-indigo-500" />,
            title: "Subject & Composition",
            details: [
                { label: "Focus", value: data.subjectAndComposition?.focus },
                { label: "Type", value: data.subjectAndComposition?.type },
            ],
            recommendation: data.subjectAndComposition?.recommendation,
        },
        {
            icon: <Type className="w-6 h-6 text-indigo-500" />,
            title: "Typography & Text",
            details: [
                { label: "Clarity", value: data.typographyAndText?.clarity },
                { label: "Hierarchy", value: data.typographyAndText?.hierarchy },
            ],
            recommendation: data.typographyAndText?.recommendation,
        },
      ];
  }, [data]);

  if (!data) {
      return (
          <div className="text-center text-slate-500 p-4">
              <p>Detailed analysis could not be loaded.</p>
          </div>
      );
  }

  return (
    <div>
      <h3 className="font-bold text-xl text-slate-800 mb-4 text-center border-t pt-6">Detailed Breakdown</h3>
      <div className="space-y-4">
        {analysisItems.map(item => <AnalysisDetailItem key={item.title} {...item} />)}
      </div>
    </div>
  );
};

const AnalysisDetailItem = ({ icon, title, vibe, details, recommendation }) => (
    <div className="bg-white border border-slate-200 rounded-lg p-4 transition-shadow hover:shadow-md">
        <div className="flex items-center mb-2">
            {icon}
            <h4 className="font-semibold text-md text-slate-700 ml-3">{title}</h4>
        </div>
        <div className="pl-9 text-sm text-slate-600 space-y-2">
            {vibe && <p><strong>Vibe:</strong> {vibe}</p>}
            {details && details.map(d => d.value && <p key={d.label}><strong>{d.label}:</strong> {d.value}</p>)}
            {recommendation && <p className="mt-2 pt-2 border-t border-slate-100"><strong className="text-indigo-600">Suggestion:</strong> {recommendation}</p>}
        </div>
    </div>
);


// --- Performance Guide Tab Content ---
const PerformanceGuide = () => {
    const principles = [
        {
            icon: <Palette className="w-8 h-8 text-rose-500" />,
            title: "Use Color Strategically",
            description: "Colors evoke emotion. Use a palette that aligns with your brand's personality and the feeling you want to inspire. High contrast between background and foreground elements (especially text) is crucial for readability.",
        },
        {
            icon: <Users className="w-8 h-8 text-sky-500" />,
            title: "Show Faces When Possible",
            description: "Human faces, especially those showing positive emotion, are incredibly effective at capturing attention and building a connection. Our brains are wired to notice faces.",
        },
        {
            icon: <Type className="w-8 h-8 text-amber-500" />,
            title: "Prioritize Text Clarity",
            description: "Your message must be readable in seconds, especially on mobile. Use large, clean fonts. Keep copy concise. Ensure a clear visual hierarchy: Headline > Benefit > Call to Action.",
        },
        {
            icon: <FileImage className="w-8 h-8 text-teal-500" />,
            title: "Keep It Simple & Focused",
            description: "A single, clear focal point is more effective than a cluttered image. The viewer should immediately understand what the ad is about. Avoid visual noise that distracts from the core message.",
        },
         {
            icon: <Star className="w-8 h-8 text-indigo-500" />,
            title: "Clear Call to Action (CTA)",
            description: "Tell the user exactly what you want them to do next ('Shop Now', 'Learn More', 'Sign Up'). Make the CTA visually distinct using a button or contrasting text.",
        },
         {
            icon: <CheckCircle className="w-8 h-8 text-emerald-500" />,
            title: "Authenticity Over Perfection",
            description: "User-generated content (UGC) and less-polished, 'real' looking photos often outperform slick, professional studio shots. They build trust and feel more relatable.",
        },
    ];

    return (
        <div className="bg-white p-6 sm:p-8 rounded-2xl shadow-lg border border-slate-200/80 animate-fade-in">
            <h2 className="text-2xl sm:text-3xl font-bold text-slate-800 mb-6">Best Practices for High-Performing Ads</h2>
            <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
                {principles.map((p) => (
                    <div key={p.title} className="bg-slate-50 p-5 rounded-xl border border-slate-200/80 hover:shadow-lg hover:-translate-y-1 transition-all">
                        <div className="flex items-center mb-3">
                           <div className="p-2 bg-white rounded-full shadow-sm mr-4">{p.icon}</div>
                           <h3 className="font-bold text-lg text-slate-800">{p.title}</h3>
                        </div>
                        <p className="text-slate-600 text-sm">{p.description}</p>
                    </div>
                ))}
            </div>
        </div>
    );
};

// Simple fade-in animation
const style = document.createElement('style');
style.textContent = `
  @keyframes fade-in {
    from { opacity: 0; transform: translateY(10px); }
    to { opacity: 1; transform: translateY(0); }
  }
  .animate-fade-in {
    animation: fade-in 0.5s ease-out forwards;
  }
`;
document.head.append(style);
```
